<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vota #53 Martin Carabal√≠ - Pacto Hist√≥rico</title>
    <!-- D3.js para el mapa -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8f4f8 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, #003366 0%, #004d99 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            text-align: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-text {
            text-align: center;
        }

        .logo {
            width: 260px;
            height: 260px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 2.5rem;
            color: #003366;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
            border: 5px solid #ffd700;
            flex-shrink: 0;
            overflow: hidden;
        }

        .logo img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            object-position: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .lema {
            font-size: 1.3rem;
            font-style: italic;
            margin-top: 0.5rem;
            opacity: 0.8;
        }

        .numero-candidato {
            background: #ffd700;
            color: #003366;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-top: 0.5rem;
            font-size: 1.2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .party-info {
            background: white;
            padding: 2.5rem;
            margin: 2rem 0;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #004d99;
        }

        /* =============================== */
        /* üéØ SISTEMA DE FILTROS */
        /* =============================== */
        .filters-section {
            background: white;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .filters-section h2 {
            color: #003366;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .search-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            padding: 0.8rem 1rem;
            border: 2px solid #e6f2ff;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #004d99;
        }

        .filter-select {
            padding: 0.8rem 1rem;
            border: 2px solid #e6f2ff;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            min-width: 200px;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: #004d99;
        }

        .filter-info {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        /* =============================== */
        /* üó∫Ô∏è MAPA DE COLOMBIA */
        /* =============================== */
        .map-section {
            background: white;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .map-section h2 {
            color: #003366;
            margin-bottom: 1.5rem;
            text-align: center;
        }

       #colombia-map {
    width: 100%;
    height: 1000px;
    background: #f8fbff;
            border-radius: 10px;
            overflow: hidden;
        }

        .department-path {
            fill: #ff9c03;
    stroke: #cc7d02;
            stroke-width: 1;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .department-path:hover {
            fill: #e68a00;
    stroke: #b36b00;
            stroke-width: 2;
        }
        

        .department-path.seleccionado {
            fill: #cc7d02;
    stroke: #ff9c03;
            stroke-width: 2;
        }
        .department-path.filtrado {
    opacity: 0.3 !important;
    fill: #cccccc !important;
}

        .department-label {
            font-size: 12px;
            font-weight: bold;
            fill: #003366;
            pointer-events: none;
            text-anchor: middle;
        }

        .map-tooltip {
            position: absolute;
            background: rgba(0, 51, 102, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        /* =============================== */
        /* üéØ MODAL DE DELEGADOS */
        /* =============================== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            right: 1.5rem;
            top: 1rem;
            font-size: 2rem;
            color: #666;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #003366;
        }

        #modal-titulo {
            color: #003366;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #004d99;
            padding-bottom: 0.5rem;
        }

        .delegado-item {
            background: #f8fbff;
            padding: 1.2rem;
            margin-bottom: 1rem;
            border-radius: 10px;
            border-left: 4px solid #004d99;
            transition: transform 0.2s ease;
        }

        .delegado-item:hover {
            transform: translateX(5px);
            background: #e6f2ff;
        }

        .delegado-nombre {
            font-weight: bold;
            color: #003366;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .delegado-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .delegado-comision {
            background: #003366;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .delegado-votos {
            background: #004d99;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .delegado-votos:hover {
            background: #003366;
            transform: scale(1.05);
        }

        footer {
            background: linear-gradient(135deg, #003366 0%, #002244 100%);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .no-results {
            text-align: center;
            color: #666;
            padding: 2rem;
            font-style: italic;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
            .modal-content { margin: 10% auto; width: 95%; }
            .search-container { flex-direction: column; }
            .search-box, .filter-select { min-width: 100%; }
            #colombia-map { height: 500px !important; }
            .department-label { font-size: 8px !important; }
.map-tooltip { font-size: 12px !important; }
        }
    </style>
</head>
<body>
   <header>
    <div class="header-content">
        <div class="logo">
            <img src="Martin.jpg" alt="Martin Carabal√≠ - Candidato #53">
        </div>
        <div class="header-text">
        <h1>Vota Senado #53 Martin Carabal√≠</h1>
        
        <p class="lema">"Todo Parece imposible hasta que se hace"</p>
        <div class="numero-candidato">#53</div>
    </header>

    <div class="container">
        <section class="party-info" style="display: none;">
            <h2>Nuestro Compromiso con Colombia</h2>
            <p>El Pacto Hist√≥rico representa la esperanza de un cambio verdadero para Colombia. Con Martin Carabal√≠ como candidato, trabajamos por una naci√≥n m√°s justa, equitativa y llena de oportunidades para todos los colombianos.</p>
        </section>

        <!-- =============================== -->
        <!-- üéØ SISTEMA DE FILTROS -->
        <!-- =============================== -->
        <section class="filters-section">
            <h2>Delegados por Departamento</h2>
            <div class="search-container">
                <input type="text" id="search-input" class="search-box" placeholder="üîç Buscar delegado por nombre...">
                <select id="comision-filter" class="filter-select">
                    <option value="">Todas las comisiones</option>
                    <!-- Las opciones se generan autom√°ticamente desde JavaScript -->
                </select>
                <select id="departamento-filter" class="filter-select">
                    <option value="">Todos los departamentos</option>
                    <!-- Las opciones se generan autom√°ticamente desde JavaScript -->
                </select>
            </div>
            <div class="filter-info">
                <p id="filter-results">Mostrando todos los delegados</p>
            </div>
        </section>

        <!-- =============================== -->
        <!-- üó∫Ô∏è MAPA DE COLOMBIA -->
        <!-- =============================== -->
        <section class="map-section">
            <h2>Departamentos de Colombia</h2>
            <div id="colombia-map"></div>
        </section>
    </div>

    <!-- =============================== -->
    <!-- üéØ MODAL DE DELEGADOS -->
    <!-- =============================== -->
    <div id="modal-delegados" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3 id="modal-titulo">Delegados - Departamento</h3>
            <div id="lista-delegados"></div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 Martin Carabal√≠. Todos los derechos reservados.</p>
            <p>#53 - Todo Parece imposible hasta que se hace</p>
        </div>
    </footer>

    <script>
        // ============================================
        // üîß DATOS DE DELEGADOS - EDITAR AQU√ç
        // ============================================

        const delegadosPorDepartamento = {
    "Amazonas": [
        {
            nombre: "Hernando Mosquera Gamboa",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_amazonas"
        }
    ],
    
    "Antioquia": [
        {
            nombre: "Beatriz Elena Quesada Cuesta",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_antioquia1"
        },
        {
            nombre: "Manuel Palacios Blandon",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_antioquia2"
        }
    ],
    
    "Arauca": [
        {
            nombre: "Jhon Jairo Hurtado Hurtado",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_arauca1"
        },
        {
            nombre: "Walberto Berdugo Arellanos",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_arauca2"
        }
    ],
    
    "Atl√°ntico": [
        {
            nombre: "Pedro Ad√†n Torres Perez",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_atlantico1"
        },
        {
            nombre: "Gilberto Lemos Sanchez",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_atlantico2"
        }
    ],
    
    "Bogot√° D.C.": [
        {
            nombre: "Nieves Mercedes Lemos Garcia",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota1"
        },
        {
            nombre: "Alejandrina Vernaza Qui√±ones",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota2"
        },
        {
            nombre: "Anyela Viviana Guanga Marquinez",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota3"
        },
        {
            nombre: "Luz Aida Angulo Angulo",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota4"
        },
        {
            nombre: "Ricardo Hurtado Bravo",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota5"
        },
        {
            nombre: "Javier Alfonso Velazques Molina",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bogota6"
        }
    ],
    
    "Bol√≠var": [
        {
            nombre: "Keinel Yoel Simarra Cassiani",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bolivar1"
        },
        {
            nombre: "Henry Mart√≠n Guizamano Vivas",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bolivar2"
        },
        {
            nombre: "Arnulfo Cardosi Julio",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bolivar3"
        },
        {
            nombre: "Williams Hernandes Graus",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_bolivar4"
        }
    ],
    
    "Boyac√°": [
        {
            nombre: "B√°rbara Machado Nagles",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_boyaca"
        }
    ],
    
    "Caldas": [
        {
            nombre: "Alonso Moreno Hernandez",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_caldas1"
        },
        {
            nombre: "Liseth Barbosa Rojas",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_caldas2"
        }
    ],
    
    "Caquet√°": [
        {
            nombre: "Juan Alexy Rodriguez Qui√±ones",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_caqueta1"
        },
        {
            nombre: "Luz Mary Cundumi Copette",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_caqueta2"
        }
    ],
    
    "Casanare": [
        {
            nombre: "Yasmid Banguero",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_casanare1"
        },
        {
            nombre: "Gener Nazarit D√≠az",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_casanare2"
        }
    ],
    
    "Cauca": [
        {
            nombre: "Yaneth Mosquera Rivera",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca1"
        },
        {
            nombre: "Paola Andrea Ararat Nzary",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca2"
        },
        {
            nombre: "Rosana Mejia Caicedo",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca3"
        },
        {
            nombre: "Nestor Segundo Hurtado Hurtado",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca4"
        },
        {
            nombre: "Roque Alfredo Riascos",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca5"
        },
        {
            nombre: "Jhon Jairo Melecio",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca6"
        },
        {
            nombre: "Wilson Osvaldo Gonzalez",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca7"
        },
        {
            nombre: "Mayra Fernanda Mejia Bermudez",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca8"
        },
        {
            nombre: "Wilner Perlaza Ortis",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cauca9"
        }
    ],
    
    "Cesar": [
        {
            nombre: "Jose Tomas Marquez Fragozo",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cesar1"
        },
        {
            nombre: "Elvis Pardo Pi√±eres",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cesar2"
        }
    ],
    
    "Choc√≥": [
        {
            nombre: "Elizabet Moreno Barco",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco1"
        },
        {
            nombre: "Jose Aristarco Mosquera",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco2"
        },
        {
            nombre: "Jose Americo Mosquera Berrio",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco3"
        },
        {
            nombre: "Valerio Santos Andrades Mosquera",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco4"
        },
        {
            nombre: "Francisco Valerio Murillo Reyes",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco5"
        },
        {
            nombre: "Deyler Mosquera Martinez",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco6"
        },
        {
            nombre: "Idalmy Minotta Teran",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco7"
        },
        {
            nombre: "German Antonio Marmolejo Renteria",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco8"
        },
        {
            nombre: "Jose Ramiro Rodriguez Correa",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco9"
        },
        {
            nombre: "Emilce Perea Cuesta",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco10"
        },
        {
            nombre: "Pedro Julio Rivas Mena",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco11"
        },
        {
            nombre: "Francisco Javier Mosquera Caicedo",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco12"
        },
        {
            nombre: "Luciano Marmolejo Mosquera",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_choco13"
        }
    ],
    
    "C√≥rdoba": [
        {
            nombre: "Mirna Luz Lloreda Cordoba",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cordoba1"
        },
        {
            nombre: "Miguel Angel Renter√≠a C√≥rdoba",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cordoba2"
        },
        {
            nombre: "Ricardo Mart√≠nez Cantillo",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cordoba3"
        }
    ],
    
    "Cundinamarca": [
        {
            nombre: "Mirla del Carmen Lloreda Gracia",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cundinamarca1"
        },
        {
            nombre: "Carlos Hernan Palacios Moreno",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cundinamarca2"
        },
        {
            nombre: "Edwin Jos√© Guerrero Mosquera",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_cundinamarca3"
        }
    ],
    
    "Guain√≠a": [
        {
            nombre: "Bisneyde Martinez renteria",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guainia1"
        },
        {
            nombre: "Bisneyder Mart√≠nez Renter√≠a",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guainia2"
        }
    ],
    
    "La Guajira": [
        {
            nombre: "Nelson Solano Duarte",
            comision: "COMISI√ìN QUINTA",
            votos: 500,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guajira1"
        },
        {
            nombre: "Eber Joaquin Ramos Aregoces",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guajira2"
        },
        {
            nombre: "Kendrys Paola Reyes Torres",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guajira3"
        },
        {
            nombre: "Amilcar Hernando Gomez Toro",
            comision: "COMISI√ìN SEGUNDA",
            votos: 400,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guajira4"
        }
    ],
    
    "Guaviare": [
        {
            nombre: "Dennis Juseth Atuesta Ibarguen",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guaviare1"
        },
        {
            nombre: "Cristian Andr√®s Monta√±o G√≥mez",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_guaviare2"
        }
    ],
    
    "Huila": [
        {
            nombre: "Victor Vladimir Vallecilla G√≥ngora",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_huila1"
        },
        {
            nombre: "Victor Vladimir Vallecilla G√≥ngora",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_huila2"
        },
        {
            nombre: "Francisco Alexis Arce Arango",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_huila3"
        }
    ],
    
    "Magdalena": [
        {
            nombre: "Jorge Emilio Montenegro Esquea",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_magdalena1"
        },
        {
            nombre: "Yomaira Olivo P√©rez",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_magdalena2"
        },
        {
            nombre: "Sandra Chiquillo Julio",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_magdalena3"
        }
    ],
    
    "Meta": [
        {
            nombre: "Marta Yaneth Lloreda Gracia",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_meta1"
        },
        {
            nombre: "Kelly Moran",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_meta2"
        },
        {
            nombre: "Debangio Valencia Chara",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_meta3"
        }
    ],
    
    "Nari√±o": [
        {
            nombre: "Kenny Fabiano Tapia Acosta",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o1"
        },
        {
            nombre: "Jeison Pineda Olaya",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o2"
        },
        {
            nombre: "H√©ctor Pablo Cabezas Cortes",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o3"
        },
        {
            nombre: "Cesar Armando Arboleda",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o4"
        },
        {
            nombre: "Aquileo Mosquera Copete",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o5"
        },
        {
            nombre: "Elsa Lucia Caldas Gongora",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o6"
        },
        {
            nombre: "Jairo Rodolfo Torres Montano",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o7"
        },
        {
            nombre: "Marleni Cisnero",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o8"
        },
        {
            nombre: "Jonny Ordo√±es Salazar",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o9"
        },
        {
            nombre: "Harrison Esneider Vidal",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o10"
        },
        {
            nombre: "Jani Jonifer Cuero Valencia",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o11"
        },
        {
            nombre: "Lady Lorena Riasco Sevillano",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o12"
        },
        {
            nombre: "Ivan Rodolfo Valencia Correa",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_nari√±o13"
        }
    ],
    
    "Norte de Santander": [
        {
            nombre: "Martin Alonso Caicedo Carabali",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_norte_santander1"
        },
        {
            nombre: "Yenifer Samira Garcia Castillo",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_norte_santander2"
        }
    ],
    
    "Putumayo": [
        {
            nombre: "Wilson Moreno Mosquer",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_putumayo1"
        },
        {
            nombre: "Vicente William Castillo Delgado",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_putumayo2"
        },
        {
            nombre: "Arley Jos√© Qui√±ones Ort√≠z",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_putumayo3"
        }
    ],
    
    "Quind√≠o": [
        {
            nombre: "Bernardo C√≥rdoba Cuesta",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_quindio1"
        },
        {
            nombre: "Luz Aida Ibarra Ibarra",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_quindio2"
        },
        {
            nombre: "Bernardo C√≥rdoba Cuesta",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_quindio3"
        }
    ],
    
    "Risaralda": [
        {
            nombre: "Aristides Pino Mosquera",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_risaralda1"
        },
        {
            nombre: "Juan Bautista Mosquera Lloreda",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_risaralda2"
        },
        {
            nombre: "Juan Bautista Mosquera Lloreda",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_risaralda3"
        }
    ],
    
    "San Andr√©s": [
        {
            nombre: "Charles Ronald COTES TORRES",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_san_andres1"
        },
        {
            nombre: "Roylie Eduardo Hawkins Hawkins",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_san_andres2"
        },
        {
            nombre: "Jairo Rodriguez Davis",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_san_andres3"
        }
    ],
    
    "Santander": [
        {
            nombre: "Wilson Arias Ardila",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_santander1"
        },
        {
            nombre: "Noemy Estupi√±an",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_santander2"
        }
    ],
    
    "Sucre": [
        {
            nombre: "Glorimer Rodriguez Hoyos",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_sucre1"
        },
        {
            nombre: "Juan Carlos Bayter",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_sucre2"
        },
        {
            nombre: "Guillermo Castro Teheran",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_sucre3"
        }
    ],
    
    "Tolima": [
        {
            nombre: "Andres Felipe Velasquez Mosquera",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_tolima1"
        },
        {
            nombre: "Zandy Zarley Perea Agualimpia",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_tolima2"
        }
    ],
    
    "Valle del Cauca": [
        {
            nombre: "Gonzalo Vallecilla Caicedo",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle1"
        },
        {
            nombre: "Jose Antonio Hinestroza Mosquera",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle2"
        },
        {
            nombre: "Cesar Augusto Cabezas Riascos",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle3"
        },
        {
            nombre: "Fabio Garces",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle4"
        },
        {
            nombre: "Marleny Hinestroza Sinisterra",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle5"
        },
        {
            nombre: "Erlendi Cuero",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle6"
        },
        {
            nombre: "Angel Eduardo Murillo Mosquera",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle7"
        },
        {
            nombre: "Adriana Damaris Plaza Lourido",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle8"
        },
        {
            nombre: "Daniel Jose Obando Carabali",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle9"
        },
        {
            nombre: "Martha Cecilia Jord√°n Arroyo",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle10"
        },
        {
            nombre: "Norberto Mosquera Mosquera",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle11"
        },
        {
            nombre: "Marleni Angulo Yesqquen",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_valle12"
        }
    ],
    
    "Vaup√©s": [
        {
            nombre: "James Alexis Mina Orejuela",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_vaupes1"
        },
        {
            nombre: "Luis Fernando Lasso Mina",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_vaupes2"
        }
    ],
    
    "Vichada": [
        {
            nombre: "Willinton Odiel Florez Mena",
            comision: "COMISI√ìN SEGUNDA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_vichada"
        }
    ],
    
    "Adulto Mayor": [
        {
            nombre: "Marino Sanchez Aguilar",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_adulto_mayor"
        }
    ],
    
    "Persona con discapacidad": [
        {
            nombre: "Carlos Alberto Gonzalez Escobar",
            comision: "COMISI√ìN QUINTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_discapacidad"
        }
    ],
    
    "Victimas": [
        {
            nombre: "Edinson Banguero Palomino",
            comision: "COMISI√ìN SEXTA",
            votos: 0,
            enlace: "https://docs.google.com/spreadsheets/d/ejemplo_victimas"
        }
    ]
};

        // ============================================
        // üó∫Ô∏è C√ìDIGO DEL MAPA Y FUNCIONALIDAD
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('modal-delegados');
            const modalTitulo = document.getElementById('modal-titulo');
            const listaDelegados = document.getElementById('lista-delegados');
            const closeModal = document.querySelector('.close-modal');
            const searchInput = document.getElementById('search-input');
            const comisionFilter = document.getElementById('comision-filter');
            const departamentoFilter = document.getElementById('departamento-filter');
            const filterResults = document.getElementById('filter-results');
           const mapContainer = document.getElementById('colombia-map');

            let comisionesUnicas = new Set();
            let departamentosData = [];
            let mapaCargado = false;

            // Inicializar la aplicaci√≥n
            function inicializar() {
                cargarFiltros();
                cargarMapaColombia();
                agregarEventListeners();
                actualizarResultados();
            }

            // Cargar el mapa de Colombia
            function cargarMapaColombia() {
                const width = mapContainer.clientWidth;
                const height = 1000;

                const svg = d3.select("#colombia-map")
                    
    .append("svg")
    .attr("width", width)     // ‚úÖ VUELVE A ESTO
    .attr("height", height);

                const g = svg.append("g");

                // Crear tooltip
                const tooltip = d3.select("body")
                    .append("div")
                    .attr("class", "map-tooltip")
                    .style("opacity", 0);

                // Cargar el GeoJSON - NUEVO ENLACE
                // Cargar el GeoJSON - ENLACE CONFIRMADO FUNCIONA
d3.json("https://gist.githubusercontent.com/john-guerra/43c7656821069d00dcbc/raw/3aadedf47badbdac823b00dbe259f6bc6d9e1899/colombia.geo.json")
    .then(function(colombia) {
        console.log("‚úÖ GeoJSON cargado:", colombia);
        
        // Proyecci√≥n m√°s simple
        const isMobile = window.innerWidth < 768;
const baseScale = isMobile ? 2000 : 3000;

let center = [-74, 4.5];
let translate = [width / 2, height / 2];

// üì± SOLO PARA M√ìVILES - ajustar posici√≥n
if (isMobile) {
    translate = [width / 2, height / 1.8];
}

const projection = d3.geoMercator()
    .center(center)
    .scale(baseScale)
    .translate(translate);
console.log("üì± Dispositivo:", isMobile ? "M√≥vil" : "Computadora", "Scale:", baseScale);
        // üî• DEBUG TEMPORAL - AGREGAR ESTO
console.log("üîç DEBUG MAPA:");
console.log("Scale aplicado:", projection.scale());
console.log("Width:", width, "Height:", height);
console.log("Centro:", projection.center());

        const path = d3.geoPath().projection(projection);

        // DIBUJAR FORMAS PRIMERO (paths)
        g.selectAll("path")
            .data(colombia.features)
            .enter()
            .append("path")
            .attr("class", "department-path")
            .attr("d", path)
            .attr("data-depto", d => d.properties.NOMBRE_DPT)
  .on("mouseover", function(event, d) {
    const deptoMapa = d.properties.NOMBRE_DPT;
    
    // BUSCAR COINCIDENCIA INTELIGENTE
    let cantidad = 0;
    let departamentoEncontrado = "";
    
    // Normalizar nombre del mapa (min√∫sculas, sin tildes)
    const nombreNormalizado = deptoMapa
        .toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // quita tildes
        .replace(/[^a-z0-9 ]/g, '') // solo letras y n√∫meros
        .replace(/\s+/g, ' ') // espacios m√∫ltiples a simple
        .trim();
    
    // Buscar en todos los departamentos
    Object.keys(delegadosPorDepartamento).forEach(nombreDepto => {
        // Normalizar nombre del departamento en datos
        const nombreDeptoNormalizado = nombreDepto
            .toLowerCase()
            .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
            .replace(/[^a-z0-9 ]/g, '')
            .replace(/\s+/g, ' ')
            .trim();
        
        // Verificar coincidencia
        if (nombreNormalizado === nombreDeptoNormalizado || 
            nombreNormalizado.includes(nombreDeptoNormalizado) ||
            nombreDeptoNormalizado.includes(nombreNormalizado)) {
            departamentoEncontrado = nombreDepto;
            cantidad = delegadosPorDepartamento[nombreDepto].length;
        }
    });
    
    console.log("üîç Mapa:", deptoMapa, "| üìä Datos:", departamentoEncontrado, "| üë• Cantidad:", cantidad);
    
    tooltip.transition().duration(200).style("opacity", .9);
    tooltip.html(`<strong>${deptoMapa}</strong><br/>${cantidad} delegado${cantidad !== 1 ? 's' : ''}`)
        .style("left", (event.pageX + 10) + "px")
        .style("top", (event.pageY - 28) + "px");

    d3.select(this).style("fill", "#004d99");
})
            .on("mouseout", function(d) {
    tooltip.transition().duration(500).style("opacity", 0);
    d3.select(this).style("fill", "#ff9c03");  // ‚úÖ NARANJA BASE
})
            .on("click", function(event, d) {
    const depto = d.properties.NOMBRE_DPT;
    mostrarDelegados(depto);
    
    // Resaltar selecci√≥n
    g.selectAll(".department-path").style("fill", "#ff9c03");  // ‚úÖ NARANJA BASE
    d3.select(this).style("fill", "#cc7d02");  // ‚úÖ NARANJA OSCURO
})

        // LUEGO ETIQUETAS
        g.selectAll("text")
            .data(colombia.features)
            .enter()
            .append("text")
            .attr("class", "department-label")
            .attr("transform", d => `translate(${path.centroid(d)})`)
            .attr("dy", ".35em")
            .text(d => {
                const nombre = d.properties.NOMBRE_DPT;
                if (nombre === "Norte de Santander") return "N. Santander";
                if (nombre === "Archipi√©lago de San Andr√©s") return "San Andr√©s";
                if (nombre.length > 8) return nombre.substring(0, 8) + ".";
                return nombre;
            });

        mapaCargado = true;
    })
    .catch(function(error) {
        console.error("‚ùå Error cargando el mapa:", error);
        mapContainer.innerHTML = `
            <div style="text-align: center; padding: 2rem; color: #666;">
                <h3>Error cargando el mapa</h3>
                <p>No se pudo cargar el mapa de Colombia: ${error.message}</p>
            </div>
        `;
    });
            }
            //             // Cargar opciones de filtros
            function cargarFiltros() {
                departamentosData = Object.keys(delegadosPorDepartamento).sort();

                // Cargar comisiones √∫nicas
                Object.values(delegadosPorDepartamento).forEach(delegados => {
                    delegados.forEach(delegado => {
                        if (delegado.comision) {
                            comisionesUnicas.add(delegado.comision);
                        }
                    });
                });

                // Agregar opciones de comisi√≥n al select
                comisionFilter.innerHTML = '<option value="">Todas las comisiones</option>';
                [...comisionesUnicas].sort().forEach(comision => {
                    const option = document.createElement('option');
                    option.value = comision;
                    option.textContent = comision;
                    comisionFilter.appendChild(option);
                });

                // Agregar opciones de departamento al select
                departamentoFilter.innerHTML = '<option value="">Todos los departamentos</option>';
                departamentosData.forEach(depto => {
                    const option = document.createElement('option');
                    option.value = depto;
                    option.textContent = depto;
                    departamentoFilter.appendChild(option);
                });
            }

            // Funci√≥n para mapear nombres entre GeoJSON y datos
            // Funci√≥n para mapear nombres entre GeoJSON y datos
function mapearNombreDepartamento(nombreGeoJSON) {
    console.log("üîÑ Mapeando:", nombreGeoJSON);
    
    const mapeo = {
        // Mapeo COMPLETO y CORRECTO
        "Amazonas": "Amazonas",
        "Antioquia": "Antioquia", 
        "Arauca": "Arauca",
        "Atl√°ntico": "Atl√°ntico",
        "Bogot√° D.C.": "Bogot√° D.C.",
        "Bol√≠var": "Bol√≠var",
        "Boyac√°": "Boyac√°",
        "Caldas": "Caldas",
        "Caquet√°": "Caquet√°", 
        "Casanare": "Casanare",
        "Cauca": "Cauca",
        "Cesar": "Cesar",
        "Choc√≥": "Choc√≥",
        "C√≥rdoba": "C√≥rdoba",
        "Cundinamarca": "Cundinamarca",
        "Guain√≠a": "Guain√≠a",
        "Guaviare": "Guaviare",
        "Huila": "Huila", 
        "La Guajira": "La Guajira",
        "Magdalena": "Magdalena",
        "Meta": "Meta",
        "Nari√±o": "Nari√±o",
        "Norte de Santander": "Norte de Santander",
        "Putumayo": "Putumayo",
        "Quind√≠o": "Quind√≠o",
        "Risaralda": "Risaralda", 
        "Santander": "Santander",
        "Sucre": "Sucre",
        "Tolima": "Tolima",
        "Valle del Cauca": "Valle del Cauca",
        "Vaup√©s": "Vaup√©s",
        "Vichada": "Vichada",
        "Archipi√©lago de San Andr√©s, Providencia y Santa Catalina": "San Andr√©s"
    };
    
    const resultado = mapeo[nombreGeoJSON] || nombreGeoJSON;
    console.log("‚úÖ Resultado:", resultado);
    return resultado;
}

            // Actualizar mapa basado en filtros
 function actualizarMapaConFiltros() {
    if (!mapaCargado) return;

    const searchTerm = searchInput.value.toLowerCase();
    const comisionSeleccionada = comisionFilter.value;
    const departamentoSeleccionado = departamentoFilter.value;
                console.log("=== üéØ DEBUG FILTROS ===");
    console.log("Search Term:", searchTerm);
    console.log("Comisi√≥n Seleccionada:", comisionSeleccionada);
    console.log("Departamento Seleccionado:", departamentoSeleccionado);
    console.log("=== FIN DEBUG ===");

    // üó∫Ô∏è MAPEO MANUAL GARANTIZADO entre nombres de mapa y datos
    const mapeoDepartamentos = {
        "Amazonas": "Amazonas",
        "Antioquia": "Antioquia", 
        "Arauca": "Arauca",
        "Atl√°ntico": "Atl√°ntico",
        "Bogot√° D.C.": "Bogot√° D.C.",
        "Bol√≠var": "Bol√≠var",
        "Boyac√°": "Boyac√°",
        "Caldas": "Caldas",
        "Caquet√°": "Caquet√°", 
        "Casanare": "Casanare",
        "Cauca": "Cauca",
        "Cesar": "Cesar",
        "Choc√≥": "Choc√≥",
        "C√≥rdoba": "C√≥rdoba",
        "Cundinamarca": "Cundinamarca",
        "Guain√≠a": "Guain√≠a",
        "Guaviare": "Guaviare",
        "Huila": "Huila", 
        "La Guajira": "La Guajira",
        "Magdalena": "Magdalena",
        "Meta": "Meta",
        "Nari√±o": "Nari√±o",
        "Norte de Santander": "Norte de Santander",
        "Putumayo": "Putumayo",
        "Quind√≠o": "Quind√≠o",
        "Risaralda": "Risaralda", 
        "Santander": "Santander",
        "Sucre": "Sucre",
        "Tolima": "Tolima",
        "Valle del Cauca": "Valle del Cauca",
        "Vaup√©s": "Vaup√©s",
        "Vichada": "Vichada",
        "Archipi√©lago de San Andr√©s, Providencia y Santa Catalina": "San Andr√©s"
    };

    d3.selectAll(".department-path")
        .classed("filtrado", function(d) {
            const deptoMapa = d.properties.NOMBRE_DPT;
            
            // üî• USAR MAPEO MANUAL GARANTIZADO
            const departamentoEnDatos = mapeoDepartamentos[deptoMapa] || deptoMapa;
            const delegadosDelDepto = delegadosPorDepartamento[departamentoEnDatos] || [];
            
            console.log("üîç Filtro - Mapa:", deptoMapa, "| Datos:", departamentoEnDatos, "| Delegados:", delegadosDelDepto.length);
            
            // Si no hay delegados en este departamento, mostrar tenue
            if (delegadosDelDepto.length === 0) {
                console.log("‚ùå Sin delegados");
                return true;
            }
            
            // Aplicar filtros
            const tieneDelegadosFiltrados = delegadosDelDepto.some(delegado => {
                const coincideNombre = !searchTerm || delegado.nombre.toLowerCase().includes(searchTerm);
                const coincideComision = !comisionSeleccionada || delegado.comision === comisionSeleccionada;
                const coincideDepartamento = !departamentoSeleccionado || departamentoEnDatos === departamentoSeleccionado;
                
                const coincide = coincideNombre && coincideComision && coincideDepartamento;
                if (coincide) console.log("‚úÖ Coincide filtro:", delegado.nombre);
                
                return coincide;
            });
            // RESALTAR si coincide con filtro de departamento
          //  if (departamentoSeleccionado && departamentoEnDatos === departamentoSeleccionado && tieneDelegadosFiltrados) {
            //    d3.select(this).style("fill", "#003366");
              //  console.log("üéØ Resaltando:", deptoMapa);
            //} else {
               // d3.select(this).style("fill", "#e6f2ff");
            //}

            console.log("üìä Resultado final - Filtrado:", !tieneDelegadosFiltrados);
            return !tieneDelegadosFiltrados;
        });
}
            // Agregar event listeners
            function agregarEventListeners() {
                closeModal.addEventListener('click', cerrarModal);
                window.addEventListener('click', (event) => {
                    if (event.target === modal) cerrarModal();
                });
                searchInput.addEventListener('input', function() {
                    actualizarResultados();
                    actualizarMapaConFiltros();
                });
                comisionFilter.addEventListener('change', function() {
                    actualizarResultados();
                    actualizarMapaConFiltros();
                });
                departamentoFilter.addEventListener('change', function() {
                    actualizarResultados();
                    actualizarMapaConFiltros();
                });

                // Redimensionar mapa cuando cambie el tama√±o de la ventana
                window.addEventListener('resize', function() {
    if (mapaCargado) {
        console.log("üîÑ Redimensionando ventana...");
        cargarMapaColombia();
    }
                });
            }

            // Actualizar resultados basados en filtros
            function actualizarResultados() {
                const searchTerm = searchInput.value.toLowerCase();
                const comisionSeleccionada = comisionFilter.value;
                const departamentoSeleccionado = departamentoFilter.value;

                let delegadosFiltrados = 0;
                let departamentosConResultados = 0;

                departamentosData.forEach(depto => {
                    const delegados = delegadosPorDepartamento[depto] || [];
                    const delegadosFiltradosEnDepto = delegados.filter(delegado => {
                        const coincideNombre = delegado.nombre.toLowerCase().includes(searchTerm);
                        const coincideComision = !comisionSeleccionada || delegado.comision === comisionSeleccionada;
                        const coincideDepartamento = !departamentoSeleccionado || depto === departamentoSeleccionado;
                        
                        return coincideNombre && coincideComision && coincideDepartamento;
                    });

                    if (delegadosFiltradosEnDepto.length > 0) {
                        delegadosFiltrados += delegadosFiltradosEnDepto.length;
                        departamentosConResultados++;
                    }
                });

                // Actualizar texto de resultados
                let resultadosTexto = `Mostrando ${delegadosFiltrados} delegado${delegadosFiltrados !== 1 ? 's' : ''}`;
                if (comisionSeleccionada) resultadosTexto += ` en ${comisionSeleccionada}`;
                if (departamentoSeleccionado) resultadosTexto += ` de ${departamentoSeleccionado}`;
                if (searchTerm) resultadosTexto += ` que coinciden con "${searchTerm}"`;
                
                filterResults.textContent = resultadosTexto;
            }

            // Mostrar delegados en modal
                        // Mostrar delegados en modal// ==================================================
// SISTEMA DE CORRECCI√ìN DE DEPARTAMENTOS
// ==================================================
class NormalizadorDepartamentos {
    constructor() {
        this.correcciones = {
            "casamare": "Casanare",
            "bogota d.c.": "Bogot√° D.C.", 
            "bogota dc": "Bogot√° D.C.",
            "bogota": "Bogot√° D.C.",
            "la gugiira": "La Guajira",
            "gugiira": "La Guajira",
            "botivar": "Bol√≠var",
            "gustafa": "Guain√≠a",
            "hullo": "Huila",
            "nurillo": "Nari√±o",
            "otando": "Quind√≠o",
            "risardada": "Risaralda",
            "tolana": "Tolima",
            "vuques": "Vaup√©s",
            "aduito mayor": "Adulto Mayor",
            "persona con discapacidad": "Persona con discapacidad",
            "victimas": "V√≠ctimas"
        };
    }

    normalizarTexto(texto) {
        if (!texto) return '';
        return texto.toString()
            .toLowerCase()
            .trim()
            .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
            .replace(/[^a-z0-9 ]/g, '')
            .replace(/\s+/g, ' ')
            .trim();
    }

    corregirDepartamento(departamento) {
        if (!departamento) return null;
        const normalizado = this.normalizarTexto(departamento);
        
        if (this.correcciones[normalizado]) {
            return this.correcciones[normalizado];
        }
        
        return this.capitalizarTexto(departamento);
    }

    capitalizarTexto(texto) {
        return texto.toLowerCase()
            .split(' ')
            .map(palabra => {
                if (palabra === 'd.c.') return 'D.C.';
                if (palabra === 'dc') return 'D.C.';
                return palabra.charAt(0).toUpperCase() + palabra.slice(1);
            })
            .join(' ');
    }

    encontrarMejorCoincidencia(departamentoBuscado, listaDepartamentos) {
        const corregido = this.corregirDepartamento(departamentoBuscado);
        const normalizadoBuscado = this.normalizarTexto(corregido);

        const coincidencias = listaDepartamentos.filter(depto => {
            const normalizadoDisponible = this.normalizarTexto(depto);
            return normalizadoDisponible === normalizadoBuscado;
        });

        return {
            departamentoOriginal: departamentoBuscado,
            departamentoCorregido: corregido,
            coincidenciasExactas: coincidencias,
            mejorCoincidencia: coincidencias.length > 0 ? coincidencias[0] : null,
            encontrado: coincidencias.length > 0
        };
    }
}

// FUNCI√ìN MEJORADA PARA MOSTRAR DELEGADOS
function mostrarDelegados(nombreDepartamento) {
    const normalizador = new NormalizadorDepartamentos();
    const todosDepartamentos = Object.keys(delegadosPorDepartamento);
    
    console.log("=== DEBUG MEJORADO DELEGADOS ===");
    console.log("üîç Departamento recibido:", nombreDepartamento);
    console.log("üìã Todos los departamentos disponibles:", todosDepartamentos);
    
    // CORREGIR EL NOMBRE DEL DEPARTAMENTO
    const resultadoCorreccion = normalizador.encontrarMejorCoincidencia(nombreDepartamento, todosDepartamentos);
    
    console.log("üîÑ Departamento corregido:", resultadoCorreccion.departamentoCorregido);
    console.log("‚úÖ ¬øCoincidencia encontrada?", resultadoCorreccion.encontrado);
    console.log("üéØ Mejor coincidencia:", resultadoCorreccion.mejorCoincidencia);
    
    // USAR EL DEPARTAMENTO CORREGIDO para buscar delegados
    const departamentoFinal = resultadoCorreccion.encontrado ? resultadoCorreccion.mejorCoincidencia : nombreDepartamento;
    const delegados = delegadosPorDepartamento[departamentoFinal] || [];
    
    console.log("üë• Delegados encontrados para", departamentoFinal + ":", delegados);
    console.log("=== FIN DEBUG MEJORADO ===");

                const searchTerm = searchInput.value.toLowerCase();
                const comisionSeleccionada = comisionFilter.value;
                const departamentoSeleccionado = departamentoFilter.value;

                // Filtrar delegados seg√∫n los filtros activos
                const delegadosFiltrados = delegados.filter(delegado => {
                    const coincideNombre = delegado.nombre.toLowerCase().includes(searchTerm);
                    const coincideComision = !comisionSeleccionada || delegado.comision === comisionSeleccionada;
                    const coincideDepartamento = !departamentoSeleccionado || nombreDepartamento === departamentoSeleccionado;
                    
                    return coincideNombre && coincideComision && coincideDepartamento;
                });

                modalTitulo.textContent = `Delegados - ${nombreDepartamento} (${delegadosFiltrados.length})`;
                listaDelegados.innerHTML = '';

                if (delegadosFiltrados.length === 0) {
                    listaDelegados.innerHTML = `
                        <div class="no-results">
                            <p>No hay delegados que coincidan con los filtros aplicados.</p>
                            <p><small>Departamento: ${nombreDepartamento}</small></p>
                        </div>
                    `;
                } else {
                    delegadosFiltrados.forEach(delegado => {
                        const delegadoElement = document.createElement('div');
                        delegadoElement.className = 'delegado-item';
                        delegadoElement.innerHTML = `
                            <div class="delegado-nombre">${delegado.nombre}</div>
                            <div class="delegado-info">
                                <span class="delegado-comision">${delegado.comision}</span>
                                <a href="${delegado.enlace}" target="_blank" class="delegado-votos" 
                                   onclick="event.stopPropagation();">
                                    ${delegado.votos.toLocaleString()} votos
                                </a>
                            </div>
                        `;
                        listaDelegados.appendChild(delegadoElement);
                    });
                }

                modal.style.display = 'block';
            }
            function cerrarModal() {
                modal.style.display = 'none';
                // Limpiar selecci√≥n del mapa
                d3.selectAll(".department-path").classed("seleccionado", false);
            }
            // Inicializar la aplicaci√≥n
            inicializar();
            // ==================================================
// üîê PANEL ADMINISTRATIVO COMPLETO
// ==================================================

// üîÑ ACTUALIZAR FILTROS
function actualizarFiltros() {
    const departamentoFilter = document.getElementById('departamento-filter');
    departamentoFilter.innerHTML = '<option value="">Todos los departamentos</option>';
    
    Object.keys(delegadosPorDepartamento).sort().forEach(depto => {
        const option = document.createElement('option');
        option.value = depto;
        option.textContent = depto;
        departamentoFilter.appendChild(option);
    });
    
    console.log('‚úÖ Filtros actualizados');
}

// üî• REEMPLAZA ESTA URL CON LA TUYA
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/TU_SCRIPT_ID/exec';

// üîÑ CARGAR DATOS DESDE GOOGLE SHEETS
async function cargarDelegadosDesdeSheets() {
    try {
        const response = await fetch(GOOGLE_SCRIPT_URL);
        const delegados = await response.json();
        
        const nuevosDelegados = {};
        delegados.forEach(delegado => {
            if (!nuevosDelegados[delegado.departamento]) {
                nuevosDelegados[delegado.departamento] = [];
            }
            nuevosDelegados[delegado.departamento].push({
                nombre: delegado.nombre,
                comision: delegado.comision,
                votos: 0,
                enlace: delegado.enlace
            });
        });
        
        // Limpiar y reconstruir completamente
        Object.keys(delegadosPorDepartamento).forEach(key => delete delegadosPorDepartamento[key]);
        Object.assign(delegadosPorDepartamento, nuevosDelegados);
        
        actualizarFiltros();
        
    } catch (error) {
        console.error('Error cargando delegados:', error);
    }
}

// ‚ûï AGREGAR DELEGADO
async function agregarDelegado() {
    const nombre = document.getElementById('admin-nombre').value;
    const departamento = document.getElementById('admin-departamento').value;
    const comision = document.getElementById('admin-comision').value;
    const enlace = document.getElementById('admin-enlace').value;
    
    if (!nombre || !departamento || !comision) {
        alert('Completa todos los campos');
        return;
    }
    
    try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({
                departamento: departamento,
                nombre: nombre,
                comision: comision,
                enlace: enlace
            })
        });
        
        const resultado = await response.json();
        if (resultado.success) {
            await cargarDelegadosDesdeSheets();
            document.getElementById('admin-nombre').value = '';
            document.getElementById('admin-enlace').value = '';
            alert('‚úÖ Delegado agregado');
        }
    } catch (error) {
        alert('‚ùå Error al agregar');
    }
}

// üîê FUNCIONES DEL PANEL
function mostrarPanelAdmin() {
    document.getElementById('panel-admin').style.display = 'block';
    cargarDepartamentosEnSelect();
}

function cerrarPanelAdmin() {
    document.getElementById('panel-admin').style.display = 'none';
}

function cargarDepartamentosEnSelect() {
    const select = document.getElementById('admin-departamento');
    select.innerHTML = '<option value="">Seleccionar departamento</option>';
    
    Object.keys(delegadosPorDepartamento).forEach(depto => {
        const option = document.createElement('option');
        option.value = depto;
        option.textContent = depto;
        select.appendChild(option);
    });
}

// üéπ DETECCI√ìN DE TECLAS
let adminKeyCount = 0;
document.addEventListener('keydown', function(e) {
    if (e.key === 'a' || e.key === 'A') {
        adminKeyCount++;
        if (adminKeyCount === 3) {
            document.getElementById('btn-admin').style.display = 'block';
            adminKeyCount = 0;
            console.log('üîß Panel administrativo activado');
        }
        setTimeout(() => { adminKeyCount = 0; }, 2000);
    }
});

// üì± CARGAR AL INICIAR
document.addEventListener('DOMContentLoaded', function() {
    cargarDelegadosDesdeSheets();
});
        });
        // ==================================================
// üîê PANEL ADMINISTRATIVO CON GOOGLE SHEETS
// ==================================================

// üî• REEMPLAZA ESTA URL CON LA TUYA
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwluQjpgQ5srF2WwGIflUig1NqoI0_iOn2nKairjBxEPQ851IQGTTIuPMflyr3oX6UPcQ/exec';

// üîÑ CARGAR DATOS DESDE GOOGLE SHEETS
async function cargarDelegadosDesdeSheets() {
    try {
        const response = await fetch(GOOGLE_SCRIPT_URL);
        const delegados = await response.json();
        
        const nuevosDelegados = {};
        delegados.forEach(delegado => {
            if (!nuevosDelegados[delegado.departamento]) {
                nuevosDelegados[delegado.departamento] = [];
            }
            nuevosDelegados[delegado.departamento].push({
                nombre: delegado.nombre,
                comision: delegado.comision,
                votos: 0,
                enlace: delegado.enlace
            });
        });
        
        Object.assign(delegadosPorDepartamento, nuevosDelegados);
        actualizarFiltros();
        
    } catch (error) {
        console.error('Error cargando delegados:', error);
    }
}

// ‚ûï AGREGAR DELEGADO
async function agregarDelegado() {
    const nombre = document.getElementById('admin-nombre').value;
    const departamento = document.getElementById('admin-departamento').value;
    const comision = document.getElementById('admin-comision').value;
    const enlace = document.getElementById('admin-enlace').value;
    
    if (!nombre || !departamento || !comision) {
        alert('Completa todos los campos');
        return;
    }
    
    try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({
                departamento: departamento,
                nombre: nombre,
                comision: comision,
                enlace: enlace
            })
        });
        
        const resultado = await response.json();
        if (resultado.success) {
            await cargarDelegadosDesdeSheets();
            document.getElementById('admin-nombre').value = '';
            document.getElementById('admin-enlace').value = '';
            alert('‚úÖ Delegado agregado');
        }
    } catch (error) {
        alert('‚ùå Error al agregar');
    }
}

// üì± CARGAR AL INICIAR
document.addEventListener('DOMContentLoaded', function() {
    cargarDelegadosDesdeSheets();
});
        // üîê FUNCIONES DEL PANEL ADMINISTRATIVO
function mostrarPanelAdmin() {
    document.getElementById('panel-admin').style.display = 'block';
    cargarDepartamentosEnSelect();
}

function cerrarPanelAdmin() {
    document.getElementById('panel-admin').style.display = 'none';
}

function cargarDepartamentosEnSelect() {
    const select = document.getElementById('admin-departamento');
    select.innerHTML = '<option value="">Seleccionar departamento</option>';
    
    Object.keys(delegadosPorDepartamento).forEach(depto => {
        const option = document.createElement('option');
        option.value = depto;
        option.textContent = depto;
        select.appendChild(option);
    });
}

// üéπ DETECCI√ìN DE TECLAS (presionar 'A' 3 veces)
let adminKeyCount = 0;
document.addEventListener('keydown', function(e) {
    if (e.key === 'a' || e.key === 'A') {
        adminKeyCount++;
        if (adminKeyCount === 3) {
            document.getElementById('btn-admin').style.display = 'block';
            adminKeyCount = 0;
            console.log('üîß Panel administrativo activado');
        }
        // Reset despu√©s de 2 segundos
        setTimeout(() => { adminKeyCount = 0; }, 2000);
    }
});

// üñ±Ô∏è EVENTO DEL BOT√ìN ADMIN
document.getElementById('btn-admin').addEventListener('click', mostrarPanelAdmin);
    </script>
            <!-- üîê PANEL ADMINISTRATIVO -->
<div id="panel-admin" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <span class="close-modal" onclick="cerrarPanelAdmin()">&times;</span>
        <h3>üîê Panel Administrativo</h3>
        
        <div class="form-agregar">
            <h4>Agregar Nuevo Delegado</h4>
            <input type="text" id="admin-nombre" placeholder="Nombre completo" class="search-box">
            <select id="admin-departamento" class="filter-select">
                <option value="">Seleccionar departamento</option>
            </select>
            <select id="admin-comision" class="filter-select">
                <option value="COMISI√ìN QUINTA">COMISI√ìN QUINTA</option>
                <option value="COMISI√ìN SEGUNDA">COMISI√ìN SEGUNDA</option>
                <option value="COMISI√ìN SEXTA">COMISI√ìN SEXTA</option>
            </select>
            <input type="text" id="admin-enlace" placeholder="Enlace Google Sheets" class="search-box">
            <button onclick="agregarDelegado()" class="delegado-votos">‚ûï Agregar Delegado</button>
        </div>
    </div>
</div>

<button id="btn-admin" onclick="mostrarPanelAdmin()" style="position: fixed; bottom: 20px; right: 20px; background: #ff9c03; color: white; border: none; padding: 10px; border-radius: 50%; display: none; cursor: pointer; z-index: 10000;">üîß</button>
</body>
</html>
